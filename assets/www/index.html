<!DOCTYPE html>
<html>

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.67, minimum-scale=0.67, maximum-scale=0.67, user-scalable=no, target-densityDpi=device-dpi" />
    <link rel="stylesheet" type="text/css" href="css/index.css" />
            <script charset="utf-8" src = "jquery-1.10.1.min.js"></script>
            <script charset="utf-8" src = "cordova.js"></script>
            <script type="text/javascript" charset="utf-8" src="childbrowser.js"></script>
            <script type="text/javascript" 
    src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;sensor=true&amp;libraries=places">
</script> 
<style>
      #map_canvas {
        width: 500px;
        height: 400px;
            background-color: #CCC;

      }
      </style>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Device Properties Example</title>

    <script type="text/javascript" charset="utf-8">
    
    var map;
    var myMarker;

    // Wait for device API libraries to load
    //
    //document.addEventListener("deviceready", onDeviceReady, false);

    // device APIs are available
    //
    
        document.addEventListener("deviceready", onDeviceReady, false);
    var overlay;

USGSOverlay.prototype = new google.maps.OverlayView();

function drawMarker(map, curPosition)
{
var myMarker2 = new google.maps.Marker({
  position: curPosition,
  map: map,
  title:"Apple Computer"
});
}


function initialize(floor) {
  var swBound = new google.maps.LatLng(38.9604025, -77.0920182);
  var neBound = new google.maps.LatLng(38.9623025, -77.0892782);
  var bounds = new google.maps.LatLngBounds(swBound, neBound);

  // Photograph courtesy of the U.S. Geological Survey
  var srcImage = 'FloorPlans/' + floor + '.png';
  overlay = new USGSOverlay(bounds, srcImage, map);
}

/** @constructor */
function USGSOverlay(bounds, image, map) {

  // Now initialize all properties.
  this.bounds_ = bounds;
  this.image_ = image;
  this.map_ = map;

  // We define a property to hold the image's div. We'll
  // actually create this div upon receipt of the onAdd()
  // method so we'll leave it null for now.
  this.div_ = null;

  // Explicitly call setMap on this overlay
  this.setMap(map);
}

USGSOverlay.prototype.onAdd = function() {

  // Note: an overlay's receipt of onAdd() indicates that
  // the map's panes are now available for attaching
  // the overlay to the map via the DOM.

  // Create the DIV and set some basic attributes.
  var div = document.createElement('div');
  div.style.borderStyle = 'none';
  div.style.borderWidth = '0px';
  div.style.position = 'absolute';

  // Create an IMG element and attach it to the DIV.
  var img = document.createElement('img');
  img.src = this.image_;
  img.style.width = '100%';
  img.style.height = '100%';
  img.style.position = 'absolute';
  div.appendChild(img);

  // Set the overlay's div_ property to this DIV
  this.div_ = div;

  // We add an overlay to a map via one of the map's panes.
  // We'll add this overlay to the overlayLayer pane.
  var panes = this.getPanes();
  panes.overlayLayer.appendChild(div);
}

USGSOverlay.prototype.draw = function() {

  // Size and position the overlay. We use a southwest and northeast
  // position of the overlay to peg it to the correct position and size.
  // We need to retrieve the projection from this overlay to do this.
  var overlayProjection = this.getProjection();

  // Retrieve the southwest and northeast coordinates of this overlay
  // in latlngs and convert them to pixels coordinates.
  // We'll use these coordinates to resize the DIV.
  var sw = overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());
  var ne = overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());

  // Resize the image's DIV to fit the indicated dimensions.
  var div = this.div_;
  div.style.left = sw.x + 'px';
  div.style.top = ne.y + 'px';
  div.style.width = (ne.x- sw.x) + 'px';
  div.style.height = (sw.y - ne.y) + 'px';
}

USGSOverlay.prototype.onRemove = function() {
  this.div_.parentNode.removeChild(this.div_);
  this.div_ = null;
}

google.maps.event.addDomListener(window, 'load', initialize);


    function onDeviceReady() {
          var myLatLng = new google.maps.LatLng(38.9616125, -77.0914382);
          var image = "img/bluedot.png"
  var mapOptions = {
    zoom: 18,
    center: myLatLng,
    mapTypeId: google.maps.MapTypeId.SATELLITE
  };
  map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
   myMarker = new google.maps.Marker({
       position: myLatLng,
        map: map,
        icon: image,
        });

        
           var options = { frequency: 15000 };
        watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
    }
    // onSuccess Geolocation
    //
    function onSuccess(position) {
    
        var currentlat =  position.coords.latitude;
        var currentlong = position.coords.longitude;
        var curPosition = new google.maps.LatLng(currentlat, currentlong);       
   // var latlng2 = new google.maps.LatLng(38.961389, -77.090833);\
   myMarker.setPosition(curPosition);
   
        document.getElementById("geolocation").innerHTML = "Current Location: GEICO Plaza" + "<br>" + "<button onclick=\"initialize('plazaone')\">First Floor</button> <br> <button onclick=\"initialize('plazatwo')\">Second Floor</button> <br> <button onclick=\"initialize('plazathree')\">Third Floor</button> <br> <button onclick=\"initialize('plazafour')\">Fourth Floor</button>"//"Current office: " + pos;
    }
    // onError Callback receives a PositionError object
    //
    function onError(error) {
        alert('code: '    + error.code    + '\n' +
              'message: ' + error.message + '\n');
    }
    </script>
  </head>
  <body>
  
    <footer style = "position:fixed; clear:both;"><p id="geolocation">Finding geolocation...</p></footer>
<div id="map-canvas" style="width:500px;height:500px;"></div>
</body>
</html>        

